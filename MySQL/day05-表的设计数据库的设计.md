# 表的设计/数据库的设计

> 引入：
>
> 如果面试官问你：谈谈你的xx项目里面，数据库是如何设计的？
>
> 这个问题问的是什么？
>
> 问的是你的数据库里有几个表，每个表都是干啥的；每个表里都有哪些列，这些列又是干嘛的。其实面试官问你这个问题，是想问这个项目是不是自己实现的，调项目里的细节问你，就能看出这个项目是你自己做的，还是照抄的。（简历一定要实事求是，只写会的，不会的不熟悉的就不写）。对于不实事求是的行为一般都认为是非常严重的问题（零容忍），公司里的逻辑和学校都很不一样！！

## 设计思路

数据库的设计，主要思路

1、根据需求，找到“实体”

2、梳理清楚，实体之间的关系

找到实体，就类似于面向对象程序设计，“找对象”- 需求中的关键性的名词，实体找完之后，就找出这些实体中的关系（一对一，一对多，多对多，没关系）。一般来说，我们每个实体都会安排一个表，表的设计样受到表与表之间的关系的影响。关键性的名词都可以作为实体。

## 实体间关系

- 一对一关系：

例如：学生信息，账号信息（学生和账号就是一对一的关系）

一个学生对应一个账号 （学生信息：学号、姓名、班级、性别...）

一个账号对应一个学生 （账号信息：注册时间、账号、密码...）

上述的一对一的关系就有多种方式

1. 所有的信息都放在一个表中 

   student-account（学号、姓名、性别、密码、用户名...）。缺点就是学生和账户的耦合度过高，不利于观察

2. 在学生表里，把账号id作为一个记录

   student（studentId，name，gender，accountId）

   account（accountId，password，username）

3. 或者，可以在账号表张加一个学生Id，也就是把学生Id作为账号里的一个记录

   student（name，gender，studentId）

   account（studentId，password，accountId）

- 一对多关系：

  班级-学生

  一个班级，可以包含多个学生

  一个学生，只能属于一个班级

  1) ×

  student（studentId，name，gender...）

  class（classId，classname，studentList）

  这种不太好，因为在MySQL中没有“数组”这种类型，这种很难去表示 。

  2) √

  student（name，gender，classId）

  class（classId，classname ）

  这种方式是更加常见的方式

- 多对多关系：

  学生-课程

  一个学生，可以选择多个课程

  一个课程，可以被多个学生选择

  **多对多的表结构，通常需要使用一个“关联表”，把两个实体表给关联起来。**

  student(sudentId,name,gender)

  course(courseId,name)

  关联表

  student_course(studentId,coruseId)

  ---

  除此之外就没有其他的关系了。如果两个实体之间不属于上述任何一种关系，那么两者之间就没有关系了。没有关系的表就正常设计，不用做特殊处理了。

  如果是复杂的场景，复杂的需求，实体就可能非常的多，关系也更加的错综复杂。

  **判定两个实体的关系**

  准备工作就是提前找好实体，然后如果要找两个实体之间的关系，那么就直接造句，看看是几对几的关系。

  为了解决这种复杂的问题，程序员就发明了ER（实体关系图），ER图通常在学校的课程上都会重点讲的，而且一定是期末考试的一道大题。

  ![](C:\Users\14214\Pictures\图片笔记\MySQL\实体对应关系png.png)

  ---

## 新增

这是更加复杂的新增，其实说这个事新增，但是本质还是 查询，只不过是把我们查询的结果 插入到另一个表中。（相当于是把两个sql语句组合了一下）

![](C:\Users\14214\Pictures\图片笔记\MySQL\查询（新增）— 联合使用.png)



## 聚合查询

查询的时候带表达式，也就是表达式查询，我们会把列和列放到一起进行计算，然后利用表达式查询。现在我们的“聚合查询”则是把行和行放到一起进行计算。

聚合函数

SQL中提供了一些函数，也就是 “聚合函数”，通过这些函数，就可以进行 ”行和行“的计算

| 函数                 | 说明                                      |
| -------------------- | ----------------------------------------- |
| COUNT(DISTINCT expr) | 返回查询到的数据的 数量                   |
| SUM(DISTINCT  expr)  | 返回查询到的数据的 总和，不是数字没有意义 |
| AVG(DISTINCT  expr)  | 返回查询到数据的 平均值，不是数字没有意义 |
| MAX(DISTINCT  expr)  | 返回查询到数据的 最大值，不是数组没有意义 |
| MIN(DISTINCT  expr)  | 返回查询到数据的 最小值，不是数字没意义   |



![](C:\Users\14214\Pictures\图片笔记\MySQL\聚合查询.png)

